{"version":3,"file":"dgiot-mqtt.cjs.js","sources":["../package/index.js"],"sourcesContent":["const utils = require('../utils/index.js');\nconst dgiotBus = require('@dgiot/dgiotbus');\nconst iotMqtt = require('../utils/iotMqtt');\nconst store = require('../store/index.js');\nconst moment = require('moment');\nconst { Map2Json, getMqttEventId } = utils;\nconst reconnect = true;\nconst maxReconnectNum = 100;\n// https://blog.csdn.net/qq_30849965/article/details/109109914\n// https://unpkg.com/browse/xhl-mqttx@1.0.2/readme.md\nconsole.log('dgiotBus', dgiotBus);\nconsole.log('dgiot_mqtt');\nconst dgiotmqtt = {\n  name: 'dgiotmqtt',\n  data() {\n    return {\n      consoleTale: [],\n      reconnectNum: 0,\n      isReconnect: reconnect,\n      maxReconnectNum: maxReconnectNum,\n      MapTopic: new Map(),\n    };\n  },\n  computed: {\n    mapTopic() {\n      return store.getters['mqtt/mapTopic'];\n    },\n  },\n  created() {\n    const _this = this;\n    dgiotBus.$off(`${getMqttEventId('subscribe')}`);\n    dgiotBus.$on(`${getMqttEventId('subscribe')}`, (arg, qos = 0) => {\n      console.groupCollapsed(\n        '%ciotMqtt subscribe arg',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.table(arg);\n      console.groupEnd();\n      _this.subscribe(arg, qos);\n    });\n  },\n  mounted() {},\n  methods: {\n    connectCheckTopic(map) {\n      // const map = Map2Json(this.mapTopic)\n      for (let topickey in map) {\n        if (map[topickey].endtime > Number(moment().format('x')))\n          this.subscribe({\n            topickey: topickey,\n            topic: map[topickey].topic,\n            ttl: map[topickey].endtime - Number(moment().format('x')),\n          });\n        else this.unsubscribe(topickey, map[topickey].topic);\n      }\n    },\n    /**\n     *\n     * @param topic\n     * @param payloadString\n     * @return {Vue|*}\n     */\n    busSendMsg(topic, payloadString, Message) {\n      const nowTime = Number(moment().format('x'));\n      const map = Map2Json(this.mapTopic);\n      for (let topicKey in map) {\n        if (this.checkTopic(map[topicKey].topic, topic)) {\n          const args = {\n            topic: topic,\n            msg: payloadString,\n            Message: Message,\n            timestamp: moment().format('x'),\n          };\n          dgiotBus.$emit(`${topicKey}`, args);\n          console.groupCollapsed(\n            '%ciotMqtt SendMsg payloadString',\n            'color:#009a61; font-size: 28px; font-weight: 300'\n          );\n          console.groupEnd();\n          console.table({ topic, topicKey, args });\n        }\n        if (Number(map[topicKey].endtime) < nowTime)\n          this.unsubscribe(map[topicKey].topic, topicKey);\n      }\n      console.groupCollapsed(\n        '%ciotMqtt busSendMsg payloadString',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.warn('%c%s', 'font-size: 24px;', payloadString);\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param subTopic 订阅的topic  包含#和+ 通配符\n     * @param pubTopic 发布的topic 一定不包含通配符\n     * @return {boolean}\n     */\n    checkTopic(subTopic, pubTopic) {\n      let length = pubTopic.length < subTopic.length ? pubTopic : subTopic; // 返回短的topic 短的topic 包含#/+\n      for (let k in length) {\n        if (subTopic[k] == '#' || subTopic == pubTopic) {\n          return true;\n        } else if (subTopic[k] == '+' || subTopic[k] == subTopic[k]) {\n          // return true\n        } else {\n          return false;\n        }\n      }\n    },\n    /**\n     *\n     * @param options\n     * @return {boolean}\n     */\n    initMqtt(options = {}) {\n      options = _.merge(options, {\n        time: moment(new Date()).format('YYYY-MM-DD HH:mm:ss.SSS'),\n      });\n      let _this = this;\n      if (_.isEmpty(options.id)) {\n        console.info(\n          '%c%s',\n          'color: green;font-size: 24px;',\n          'options 为空 不连接mqtt'\n        );\n        return false;\n      } else {\n        console.groupCollapsed(\n          '%ciotMqtt connect msg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.table(options);\n        console.groupEnd();\n      }\n      iotMqtt.init({\n        id: options.id,\n        ip: options.ip,\n        port: options.port,\n        userName: options.userName,\n        passWord: options.passWord,\n        success: (msg = `clientId为${options.id},iotMqtt连接成功`) => {\n          _this.mqttSuccess(msg);\n          if (!_.isEmpty(_this.mapTopic))\n            _this.connectCheckTopic(Map2Json(this.mapTopic));\n        },\n        error: function (msg = `iotMqtt接失败,自动重连`) {\n          // _this.connectLost()\n          _this.mqttError(msg);\n        },\n        connectLost: function (msg = `iotMqtt连接丢失`) {\n          // _this.connectLost()\n          _this.mqttError(msg);\n        },\n        onMessage: function (Message) {\n          _this.onMessage(Message);\n        },\n      });\n    },\n    /**\n     *\n     * @param msg\n     */\n    mqttSuccess(msg = 'success') {\n      console.groupCollapsed(\n        '%ciotMqtt connection succeeded',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.info('%c%s', 'color: green;font-size: 24px;', msg);\n      console.groupEnd();\n      // iotMqtt.subscribe(this.objectId)\n      // this.subscribe(this.objectId)\n    },\n    /**\n     *\n     * @param msg\n     */\n    mqttError(msg = 'error') {\n      let _this = this;\n      console.groupCollapsed(\n        '%ciotMqtt Connection failed',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.error('%c%s', 'color: red;font-size: 24px;', msg);\n      console.groupEnd();\n      if (this.isReconnect) {\n        _this.reconnect();\n      } else console.info('reconnect 为' + reconnect, '不自動重連');\n    },\n    /**\n     *\n     * @param msg\n     */\n    connectLost(msg = 'connectLost') {\n      console.groupCollapsed(\n        '%ciotMqtt Connection lost',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.error('%c%s', 'color: red;font-size: 24px;', msg);\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param Message\n     */\n    onMessage(Message) {\n      let _this = this;\n      const {\n        destinationName = 'destinationName',\n        duplicate = 'duplicate',\n        payloadBytes = 'payloadBytes',\n        payloadString = 'payloadString',\n        qos = 0,\n        retained = 'retained',\n      } = Message;\n      const table = {\n        destinationName: destinationName,\n        duplicate: duplicate,\n        payloadBytes: payloadBytes,\n        payloadString: payloadString,\n        qos: qos,\n        retained: retained,\n      };\n      _this.consoleTale.push(table);\n      console.groupCollapsed(\n        '%ciotMqtt onMessage',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.table(_this.consoleTale);\n      console.groupEnd();\n\n      this.busSendMsg(destinationName, payloadString, Message);\n    },\n    /**\n     *\n     * @param topickey\n     * @param topic\n     * @param ttl\n     */\n    subscribe: function (args, qos = 0) {\n      const { topicKey, topic, ttl } = args;\n      let _this = this;\n      let endTime = Number(moment().format('x')) + ttl;\n      _this.MapTopic.set(topicKey, { topic: topic, endtime: endTime });\n      // _this.setMapTopic(_this.MapTopic)\n      store.dispatch('mqttMsg/setMapTopic', _this.MapTopic);\n      if (!_.isEmpty(topic)) {\n        iotMqtt.subscribe(topic, qos);\n        console.groupCollapsed(\n          '%ciotMqtt subscribe',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.table(args);\n        console.groupEnd();\n      } else console.error('no topic');\n    },\n    /**\n     *\n     * @param topicKey 存储在vuex的key\n     * @param topic mqtt subscribe topic\n     */\n    unsubscribe: function (topicKey, topic) {\n      iotMqtt.unsubscribe(topic);\n      const map = this.mapTopic;\n      if (!_.isEmpty(map)) {\n        map.delete(topicKey);\n        // this.setMapTopic(map)\n        store.dispatch('mqttMsg/setMapTopic', map);\n      }\n      console.info('%c%s', 'color: green;font-size: 24px;', map);\n      console.groupCollapsed(\n        '%ciotMqtt unsubscribe',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.info(\n        '%c%s',\n        'color: green;font-size: 24px;',\n        'unsubscribe: topic' + topic\n      );\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param msg\n     */\n    reconnect: function (msg = '自动重连mqtt') {\n      const _this = this;\n      _this.reconnectNum++;\n      const maxReconnectNum =\n        _this.maxReconnectNum < 4 ? 4 : _this.maxReconnectNum;\n      if (_this.reconnectNum < maxReconnectNum) {\n        iotMqtt.reconnect();\n        console.groupCollapsed(\n          '%ciotMqtt reconnect',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.log(\n          '%c%s',\n          'color: black; font-size: 24px;',\n          '当前重连次数：' + _this.reconnectNum + '次' + msg\n        );\n        console.groupEnd();\n      } else {\n        console.error(\n          '%c%s',\n          'color: black;font-size: 24px;',\n          '当前重连次数大于' +\n            maxReconnectNum +\n            '次,不再自动重连,重连第' +\n            _this.reconnectNum +\n            '次'\n        );\n      }\n    },\n    /**\n     *\n     * @param topic\n     * @param obj\n     */\n    sendMessage(topic, obj, qos = 0, retained = false) {\n      if (_.isEmpty(obj)) {\n        console.groupCollapsed(\n          '%csendMsg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.error(topic, obj, '没有发送消息的内容');\n        console.groupEnd();\n        return;\n      }\n      // 数据发送\n      try {\n        iotMqtt.sendMessage(topic, obj, qos, retained);\n        console.groupCollapsed(\n          '%csendMsg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.log(topic, obj);\n        console.groupEnd();\n      } catch (err) {\n        console.log('error', err);\n        console.groupCollapsed(\n          '%ciotMqtt sendMessage error',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.warn('%c%s', 'color: red;font-size: 24px;', err);\n        console.groupEnd();\n      }\n    },\n  },\n};\n\nwindow.dgiotmqtt = dgiotmqtt;\nexport default dgiotmqtt;\n"],"names":["utils","require","dgiotBus","iotMqtt","store","moment","Map2Json","getMqttEventId","reconnect","maxReconnectNum","console","log","dgiotmqtt","name","data","consoleTale","reconnectNum","isReconnect","MapTopic","Map","computed","mapTopic","getters","created","_this","$off","$on","arg","qos","groupCollapsed","table","groupEnd","subscribe","mounted","methods","connectCheckTopic","map","topickey","endtime","Number","format","topic","ttl","unsubscribe","busSendMsg","payloadString","Message","nowTime","topicKey","checkTopic","args","msg","timestamp","$emit","warn","subTopic","pubTopic","length","k","initMqtt","options","_","merge","time","Date","isEmpty","id","info","init","ip","port","userName","passWord","success","mqttSuccess","error","mqttError","connectLost","onMessage","destinationName","duplicate","payloadBytes","retained","push","endTime","set","dispatch","sendMessage","obj","err","window"],"mappings":"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"}