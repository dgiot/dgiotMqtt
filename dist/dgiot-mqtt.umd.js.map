{"version":3,"file":"dgiot-mqtt.umd.js","sources":["../package/index.js"],"sourcesContent":["const utils = require('../utils/index.js');\nconst dgiotBus = require('@dgiot/dgiotbus');\nconst iotMqtt = require('../utils/iotMqtt');\nconst store = require('../store/index.js');\nconst moment = require('moment');\nconst { Map2Json, getMqttEventId } = utils;\nconst reconnect = true;\nconst maxReconnectNum = 100;\n// https://blog.csdn.net/qq_30849965/article/details/109109914\n// https://unpkg.com/browse/xhl-mqttx@1.0.2/readme.md\nconsole.log('dgiotBus', dgiotBus);\nconsole.log('dgiot_mqtt');\nconst dgiotmqtt = {\n  name: 'dgiotmqtt',\n  data() {\n    return {\n      consoleTale: [],\n      reconnectNum: 0,\n      isReconnect: reconnect,\n      maxReconnectNum: maxReconnectNum,\n      MapTopic: new Map(),\n    };\n  },\n  computed: {\n    mapTopic() {\n      return store.getters['mqtt/mapTopic'];\n    },\n  },\n  created() {\n    const _this = this;\n    dgiotBus.$off(`${getMqttEventId('subscribe')}`);\n    dgiotBus.$on(`${getMqttEventId('subscribe')}`, (arg, qos = 0) => {\n      console.groupCollapsed(\n        '%ciotMqtt subscribe arg',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.table(arg);\n      console.groupEnd();\n      _this.subscribe(arg, qos);\n    });\n  },\n  mounted() {},\n  methods: {\n    connectCheckTopic(map) {\n      // const map = Map2Json(this.mapTopic)\n      for (let topickey in map) {\n        if (map[topickey].endtime > Number(moment().format('x')))\n          this.subscribe({\n            topickey: topickey,\n            topic: map[topickey].topic,\n            ttl: map[topickey].endtime - Number(moment().format('x')),\n          });\n        else this.unsubscribe(topickey, map[topickey].topic);\n      }\n    },\n    /**\n     *\n     * @param topic\n     * @param payloadString\n     * @return {Vue|*}\n     */\n    busSendMsg(topic, payloadString, Message) {\n      const nowTime = Number(moment().format('x'));\n      const map = Map2Json(this.mapTopic);\n      for (let topicKey in map) {\n        if (this.checkTopic(map[topicKey].topic, topic)) {\n          const args = {\n            topic: topic,\n            msg: payloadString,\n            Message: Message,\n            timestamp: moment().format('x'),\n          };\n          dgiotBus.$emit(`${topicKey}`, args);\n          console.groupCollapsed(\n            '%ciotMqtt SendMsg payloadString',\n            'color:#009a61; font-size: 28px; font-weight: 300'\n          );\n          console.groupEnd();\n          console.table({ topic, topicKey, args });\n        }\n        if (Number(map[topicKey].endtime) < nowTime)\n          this.unsubscribe(map[topicKey].topic, topicKey);\n      }\n      console.groupCollapsed(\n        '%ciotMqtt busSendMsg payloadString',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.warn('%c%s', 'font-size: 24px;', payloadString);\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param subTopic 订阅的topic  包含#和+ 通配符\n     * @param pubTopic 发布的topic 一定不包含通配符\n     * @return {boolean}\n     */\n    checkTopic(subTopic, pubTopic) {\n      let length = pubTopic.length < subTopic.length ? pubTopic : subTopic; // 返回短的topic 短的topic 包含#/+\n      for (let k in length) {\n        if (subTopic[k] == '#' || subTopic == pubTopic) {\n          return true;\n        } else if (subTopic[k] == '+' || subTopic[k] == subTopic[k]) {\n          // return true\n        } else {\n          return false;\n        }\n      }\n    },\n    /**\n     *\n     * @param options\n     * @return {boolean}\n     */\n    initMqtt(options = {}) {\n      options = _.merge(options, {\n        time: moment(new Date()).format('YYYY-MM-DD HH:mm:ss.SSS'),\n      });\n      let _this = this;\n      if (_.isEmpty(options.id)) {\n        console.info(\n          '%c%s',\n          'color: green;font-size: 24px;',\n          'options 为空 不连接mqtt'\n        );\n        return false;\n      } else {\n        console.groupCollapsed(\n          '%ciotMqtt connect msg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.table(options);\n        console.groupEnd();\n      }\n      iotMqtt.init({\n        id: options.id,\n        ip: options.ip,\n        port: options.port,\n        userName: options.userName,\n        passWord: options.passWord,\n        success: (msg = `clientId为${options.id},iotMqtt连接成功`) => {\n          _this.mqttSuccess(msg);\n          if (!_.isEmpty(_this.mapTopic))\n            _this.connectCheckTopic(Map2Json(this.mapTopic));\n        },\n        error: function (msg = `iotMqtt接失败,自动重连`) {\n          // _this.connectLost()\n          _this.mqttError(msg);\n        },\n        connectLost: function (msg = `iotMqtt连接丢失`) {\n          // _this.connectLost()\n          _this.mqttError(msg);\n        },\n        onMessage: function (Message) {\n          _this.onMessage(Message);\n        },\n      });\n    },\n    /**\n     *\n     * @param msg\n     */\n    mqttSuccess(msg = 'success') {\n      console.groupCollapsed(\n        '%ciotMqtt connection succeeded',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.info('%c%s', 'color: green;font-size: 24px;', msg);\n      console.groupEnd();\n      // iotMqtt.subscribe(this.objectId)\n      // this.subscribe(this.objectId)\n    },\n    /**\n     *\n     * @param msg\n     */\n    mqttError(msg = 'error') {\n      let _this = this;\n      console.groupCollapsed(\n        '%ciotMqtt Connection failed',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.error('%c%s', 'color: red;font-size: 24px;', msg);\n      console.groupEnd();\n      if (this.isReconnect) {\n        _this.reconnect();\n      } else console.info('reconnect 为' + reconnect, '不自動重連');\n    },\n    /**\n     *\n     * @param msg\n     */\n    connectLost(msg = 'connectLost') {\n      console.groupCollapsed(\n        '%ciotMqtt Connection lost',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.error('%c%s', 'color: red;font-size: 24px;', msg);\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param Message\n     */\n    onMessage(Message) {\n      let _this = this;\n      const {\n        destinationName = 'destinationName',\n        duplicate = 'duplicate',\n        payloadBytes = 'payloadBytes',\n        payloadString = 'payloadString',\n        qos = 0,\n        retained = 'retained',\n      } = Message;\n      const table = {\n        destinationName: destinationName,\n        duplicate: duplicate,\n        payloadBytes: payloadBytes,\n        payloadString: payloadString,\n        qos: qos,\n        retained: retained,\n      };\n      _this.consoleTale.push(table);\n      console.groupCollapsed(\n        '%ciotMqtt onMessage',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.table(_this.consoleTale);\n      console.groupEnd();\n\n      this.busSendMsg(destinationName, payloadString, Message);\n    },\n    /**\n     *\n     * @param topickey\n     * @param topic\n     * @param ttl\n     */\n    subscribe: function (args, qos = 0) {\n      const { topicKey, topic, ttl } = args;\n      let _this = this;\n      let endTime = Number(moment().format('x')) + ttl;\n      _this.MapTopic.set(topicKey, { topic: topic, endtime: endTime });\n      // _this.setMapTopic(_this.MapTopic)\n      store.dispatch('mqttMsg/setMapTopic', _this.MapTopic);\n      if (!_.isEmpty(topic)) {\n        iotMqtt.subscribe(topic, qos);\n        console.groupCollapsed(\n          '%ciotMqtt subscribe',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.table(args);\n        console.groupEnd();\n      } else console.error('no topic');\n    },\n    /**\n     *\n     * @param topicKey 存储在vuex的key\n     * @param topic mqtt subscribe topic\n     */\n    unsubscribe: function (topicKey, topic) {\n      iotMqtt.unsubscribe(topic);\n      const map = this.mapTopic;\n      if (!_.isEmpty(map)) {\n        map.delete(topicKey);\n        // this.setMapTopic(map)\n        store.dispatch('mqttMsg/setMapTopic', map);\n      }\n      console.info('%c%s', 'color: green;font-size: 24px;', map);\n      console.groupCollapsed(\n        '%ciotMqtt unsubscribe',\n        'color:#009a61; font-size: 28px; font-weight: 300'\n      );\n      console.info(\n        '%c%s',\n        'color: green;font-size: 24px;',\n        'unsubscribe: topic' + topic\n      );\n      console.groupEnd();\n    },\n    /**\n     *\n     * @param msg\n     */\n    reconnect: function (msg = '自动重连mqtt') {\n      const _this = this;\n      _this.reconnectNum++;\n      const maxReconnectNum =\n        _this.maxReconnectNum < 4 ? 4 : _this.maxReconnectNum;\n      if (_this.reconnectNum < maxReconnectNum) {\n        iotMqtt.reconnect();\n        console.groupCollapsed(\n          '%ciotMqtt reconnect',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.log(\n          '%c%s',\n          'color: black; font-size: 24px;',\n          '当前重连次数：' + _this.reconnectNum + '次' + msg\n        );\n        console.groupEnd();\n      } else {\n        console.error(\n          '%c%s',\n          'color: black;font-size: 24px;',\n          '当前重连次数大于' +\n            maxReconnectNum +\n            '次,不再自动重连,重连第' +\n            _this.reconnectNum +\n            '次'\n        );\n      }\n    },\n    /**\n     *\n     * @param topic\n     * @param obj\n     */\n    sendMessage(topic, obj, qos = 0, retained = false) {\n      if (_.isEmpty(obj)) {\n        console.groupCollapsed(\n          '%csendMsg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.error(topic, obj, '没有发送消息的内容');\n        console.groupEnd();\n        return;\n      }\n      // 数据发送\n      try {\n        iotMqtt.sendMessage(topic, obj, qos, retained);\n        console.groupCollapsed(\n          '%csendMsg',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.log(topic, obj);\n        console.groupEnd();\n      } catch (err) {\n        console.log('error', err);\n        console.groupCollapsed(\n          '%ciotMqtt sendMessage error',\n          'color:#009a61; font-size: 28px; font-weight: 300'\n        );\n        console.warn('%c%s', 'color: red;font-size: 24px;', err);\n        console.groupEnd();\n      }\n    },\n  },\n};\n\nwindow.dgiotmqtt = dgiotmqtt;\nexport default dgiotmqtt;\n"],"names":["utils","require","dgiotBus","iotMqtt","store","moment","Map2Json","getMqttEventId","reconnect","maxReconnectNum","console","log","dgiotmqtt","name","data","consoleTale","reconnectNum","isReconnect","MapTopic","Map","computed","mapTopic","getters","created","_this","$off","$on","arg","qos","groupCollapsed","table","groupEnd","subscribe","mounted","methods","connectCheckTopic","map","topickey","endtime","Number","format","topic","ttl","unsubscribe","busSendMsg","payloadString","Message","nowTime","topicKey","checkTopic","args","msg","timestamp","$emit","warn","subTopic","pubTopic","length","k","initMqtt","options","_","merge","time","Date","isEmpty","id","info","init","ip","port","userName","passWord","success","mqttSuccess","error","mqttError","connectLost","onMessage","destinationName","duplicate","payloadBytes","retained","push","endTime","set","dispatch","sendMessage","obj","err","window"],"mappings":"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"}